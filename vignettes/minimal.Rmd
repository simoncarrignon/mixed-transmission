```{r}
devtools::load_all(".")

N=400
ki <- 1
km <- 1
K  <-  ki+km
z=5

neutraltraitsParam=initNeutralTraitsPathways(z = z)
neutraltraitsParam$s=c(0,0,1,1)
neutraltraitsParam$pre[,"v"]=c(1,1,1,0,0)

pos=random2Dgrid(K=K,Gx=100)
a=initAdaptiveTraits(ki=ki,km=km)
initcomus=initialiseCommunities(traits=a,coordinates=pos)
initcomus$size=rep(round(N/K),K)

communities=unlist(lapply(1:K,function(i)rep(i,initcomus$size[i])))
population=cbind(newpop(N,age="random",community = communities),initNeutralTraits(N,z))
quickV=modelVector(m=1, b=0.03*6, r=0, rho=.5, d=0.03, maturity=18, endrepro=65, population=population, comus=initcomus, tstep=200, tp=neutraltraitsParam, logging=c("time","visu","fission","marriage"),ma=1,traitsid=paste0("t",1:z),out=c("popsumary","finalpop","popsize","weddings"),F_Th=800)
```

Quick Visu:

```{r}
hist(quickV$population[,"age"])
hist(table(quickV$population[,"fid"]))
testpop=quickV$population
tapply(testpop[,c("fid")],testpop[,"community"],table)
```


